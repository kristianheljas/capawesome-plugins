{"version":3,"file":"plugin.cjs.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst FileCompressor = registerPlugin('FileCompressor', {\n    web: () => import('./web').then((m) => new m.FileCompressorWeb()),\n});\nexport * from './definitions';\nexport { FileCompressor };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nexport class FileCompressorWeb extends WebPlugin {\n    async compressImage(options) {\n        var _a, _b;\n        const blob = options.blob;\n        if (!blob) {\n            throw new Error(FileCompressorWeb.ERROR_FILE_MISSING);\n        }\n        const mimeType = (_a = options.mimeType) !== null && _a !== void 0 ? _a : 'image/jpeg';\n        if (mimeType !== 'image/jpeg' && mimeType !== 'image/webp') {\n            throw new Error(FileCompressorWeb.ERROR_MIME_TYPE_NOT_SUPPORTED);\n        }\n        const quality = (_b = options.quality) !== null && _b !== void 0 ? _b : 0.6;\n        if (quality < 0 || quality > 1) {\n            throw new Error(FileCompressorWeb.ERROR_QUALITY_OUT_OF_RANGE);\n        }\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.readAsDataURL(blob);\n            reader.onload = () => {\n                const base64data = reader.result;\n                const image = new Image();\n                image.src = base64data;\n                image.onload = () => {\n                    const { height, width } = image;\n                    const canvasElement = document.createElement('canvas');\n                    canvasElement.height = height;\n                    canvasElement.width = width;\n                    const canvasElementContext = canvasElement.getContext('2d');\n                    if (!canvasElementContext) {\n                        reject('Could not get canvas context.');\n                        return;\n                    }\n                    canvasElementContext.drawImage(image, 0, 0, width, height);\n                    canvasElementContext.canvas.toBlob((blob) => {\n                        if (blob) {\n                            resolve({ blob });\n                        }\n                        else {\n                            reject('Could not get blob.');\n                        }\n                        canvasElement.remove();\n                    }, mimeType, quality);\n                };\n                image.onerror = (error) => {\n                    reject(error);\n                };\n            };\n            reader.onerror = (error) => {\n                reject(error);\n            };\n        });\n    }\n}\nFileCompressorWeb.ERROR_FILE_MISSING = 'blob must be provided.';\nFileCompressorWeb.ERROR_QUALITY_OUT_OF_RANGE = 'quality must be between 0 and 1.';\nFileCompressorWeb.ERROR_MIME_TYPE_NOT_SUPPORTED = 'mimeType is not supported.';\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin"],"mappings":"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"}