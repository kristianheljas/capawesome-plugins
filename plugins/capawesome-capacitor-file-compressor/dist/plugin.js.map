{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst FileCompressor = registerPlugin('FileCompressor', {\n    web: () => import('./web').then((m) => new m.FileCompressorWeb()),\n});\nexport * from './definitions';\nexport { FileCompressor };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nexport class FileCompressorWeb extends WebPlugin {\n    async compressImage(options) {\n        var _a, _b;\n        const blob = options.blob;\n        if (!blob) {\n            throw new Error(FileCompressorWeb.ERROR_FILE_MISSING);\n        }\n        const mimeType = (_a = options.mimeType) !== null && _a !== void 0 ? _a : 'image/jpeg';\n        if (mimeType !== 'image/jpeg' && mimeType !== 'image/webp') {\n            throw new Error(FileCompressorWeb.ERROR_MIME_TYPE_NOT_SUPPORTED);\n        }\n        const quality = (_b = options.quality) !== null && _b !== void 0 ? _b : 0.6;\n        if (quality < 0 || quality > 1) {\n            throw new Error(FileCompressorWeb.ERROR_QUALITY_OUT_OF_RANGE);\n        }\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.readAsDataURL(blob);\n            reader.onload = () => {\n                const base64data = reader.result;\n                const image = new Image();\n                image.src = base64data;\n                image.onload = () => {\n                    const { height, width } = image;\n                    const canvasElement = document.createElement('canvas');\n                    canvasElement.height = height;\n                    canvasElement.width = width;\n                    const canvasElementContext = canvasElement.getContext('2d');\n                    if (!canvasElementContext) {\n                        reject('Could not get canvas context.');\n                        return;\n                    }\n                    canvasElementContext.drawImage(image, 0, 0, width, height);\n                    canvasElementContext.canvas.toBlob((blob) => {\n                        if (blob) {\n                            resolve({ blob });\n                        }\n                        else {\n                            reject('Could not get blob.');\n                        }\n                        canvasElement.remove();\n                    }, mimeType, quality);\n                };\n                image.onerror = (error) => {\n                    reject(error);\n                };\n            };\n            reader.onerror = (error) => {\n                reject(error);\n            };\n        });\n    }\n}\nFileCompressorWeb.ERROR_FILE_MISSING = 'blob must be provided.';\nFileCompressorWeb.ERROR_QUALITY_OUT_OF_RANGE = 'quality must be between 0 and 1.';\nFileCompressorWeb.ERROR_MIME_TYPE_NOT_SUPPORTED = 'mimeType is not supported.';\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin"],"mappings":"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"}